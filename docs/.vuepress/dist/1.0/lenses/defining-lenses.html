<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Defining Lenses</title>
    <meta name="description" content="Master Your Universe">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,800,800i,900,900i" rel="stylesheet" type="text/css">
    
    <link rel="preload" href="/docs/assets/css/0.styles.c13031c2.css" as="style"><link rel="preload" href="/docs/assets/js/app.bdf30820.js" as="script"><link rel="preload" href="/docs/assets/js/8.992bb95f.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.33d9c75b.js"><link rel="prefetch" href="/docs/assets/js/11.04125aff.js"><link rel="prefetch" href="/docs/assets/js/12.a4d9650f.js"><link rel="prefetch" href="/docs/assets/js/13.732f9606.js"><link rel="prefetch" href="/docs/assets/js/14.b65005b5.js"><link rel="prefetch" href="/docs/assets/js/15.8ed74723.js"><link rel="prefetch" href="/docs/assets/js/16.5158aff7.js"><link rel="prefetch" href="/docs/assets/js/17.ac3b64cb.js"><link rel="prefetch" href="/docs/assets/js/18.409cad53.js"><link rel="prefetch" href="/docs/assets/js/19.e4997522.js"><link rel="prefetch" href="/docs/assets/js/2.7910f5b1.js"><link rel="prefetch" href="/docs/assets/js/20.87635785.js"><link rel="prefetch" href="/docs/assets/js/21.8766451c.js"><link rel="prefetch" href="/docs/assets/js/22.aef19787.js"><link rel="prefetch" href="/docs/assets/js/23.20b86c12.js"><link rel="prefetch" href="/docs/assets/js/24.fb401282.js"><link rel="prefetch" href="/docs/assets/js/25.d065eeb5.js"><link rel="prefetch" href="/docs/assets/js/26.a4d3b7c1.js"><link rel="prefetch" href="/docs/assets/js/27.7c9fbd2d.js"><link rel="prefetch" href="/docs/assets/js/28.da62620f.js"><link rel="prefetch" href="/docs/assets/js/29.72596597.js"><link rel="prefetch" href="/docs/assets/js/3.89f9db17.js"><link rel="prefetch" href="/docs/assets/js/30.981aa03c.js"><link rel="prefetch" href="/docs/assets/js/31.fbf50732.js"><link rel="prefetch" href="/docs/assets/js/32.a072b256.js"><link rel="prefetch" href="/docs/assets/js/33.1b790007.js"><link rel="prefetch" href="/docs/assets/js/34.643021bc.js"><link rel="prefetch" href="/docs/assets/js/35.7cbdbf02.js"><link rel="prefetch" href="/docs/assets/js/36.e7f5058b.js"><link rel="prefetch" href="/docs/assets/js/37.89f5629e.js"><link rel="prefetch" href="/docs/assets/js/38.cd56d617.js"><link rel="prefetch" href="/docs/assets/js/39.eb6eb1e4.js"><link rel="prefetch" href="/docs/assets/js/4.fe100596.js"><link rel="prefetch" href="/docs/assets/js/40.d7a5748e.js"><link rel="prefetch" href="/docs/assets/js/41.4b8198ef.js"><link rel="prefetch" href="/docs/assets/js/42.5f5b5106.js"><link rel="prefetch" href="/docs/assets/js/5.09e7bf79.js"><link rel="prefetch" href="/docs/assets/js/6.f8e4e657.js"><link rel="prefetch" href="/docs/assets/js/7.867ff109.js"><link rel="prefetch" href="/docs/assets/js/9.353c2b7a.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.c13031c2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><img src="/docs/assets/img/logo.svg" alt="" class="logo"> <!----></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://nova.laravel.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://nova.laravel.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Getting Started</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/docs/1.0/installation.html" class="sidebar-link">Installation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/installation.html#requirements" class="sidebar-link">Requirements</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/installation.html#browser-support" class="sidebar-link">Browser Support</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/installation.html#installing-nova" class="sidebar-link">Installing Nova</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/installation.html#installing-nova-via-composer" class="sidebar-link">Installing Nova Via Composer</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/installation.html#customizing-nova-s-authentication-guard" class="sidebar-link">Customizing Nova's Authentication Guard</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/installation.html#authorizing-nova" class="sidebar-link">Authorizing Nova</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/installation.html#updating-nova" class="sidebar-link">Updating Nova</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/installation.html#bug-reports" class="sidebar-link">Bug Reports</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Resources</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/docs/1.0/resources/" class="sidebar-link">The Basics</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/resources/#defining-resources" class="sidebar-link">Defining Resources</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/#registering-resources" class="sidebar-link">Registering Resources</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/#grouping-resources" class="sidebar-link">Grouping Resources</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/#eager-loading" class="sidebar-link">Eager Loading</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/#resource-events" class="sidebar-link">Resource Events</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/#preventing-conflicts" class="sidebar-link">Preventing Conflicts</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/#keyboard-shortcuts" class="sidebar-link">Keyboard Shortcuts</a></li></ul></li><li><a href="/docs/1.0/resources/fields.html" class="sidebar-link">Fields</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/resources/fields.html#defining-fields" class="sidebar-link">Defining Fields</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/fields.html#showing-hiding-fields" class="sidebar-link">Showing / Hiding Fields</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/fields.html#field-panels" class="sidebar-link">Field Panels</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/fields.html#sortable-fields" class="sidebar-link">Sortable Fields</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/fields.html#field-types" class="sidebar-link">Field Types</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/fields.html#computed-fields" class="sidebar-link">Computed Fields</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/fields.html#customization" class="sidebar-link">Customization</a></li></ul></li><li><a href="/docs/1.0/resources/date-fields.html" class="sidebar-link">Date Fields</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/1.0/resources/file-fields.html" class="sidebar-link">File Fields</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/resources/file-fields.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/file-fields.html#images" class="sidebar-link">Images</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/file-fields.html#avatars" class="sidebar-link">Avatars</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/file-fields.html#storing-metadata" class="sidebar-link">Storing Metadata</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/file-fields.html#pruning" class="sidebar-link">Pruning</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/file-fields.html#customization" class="sidebar-link">Customization</a></li></ul></li><li><a href="/docs/1.0/resources/relationships.html" class="sidebar-link">Relationships</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/resources/relationships.html#hasone" class="sidebar-link">HasOne</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/relationships.html#hasmany" class="sidebar-link">HasMany</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/relationships.html#belongsto" class="sidebar-link">BelongsTo</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/relationships.html#belongstomany" class="sidebar-link">BelongsToMany</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/relationships.html#morphmany" class="sidebar-link">MorphMany</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/relationships.html#morphto" class="sidebar-link">MorphTo</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/relationships.html#morphtomany" class="sidebar-link">MorphToMany</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/relationships.html#searchable-relations" class="sidebar-link">Searchable Relations</a></li></ul></li><li><a href="/docs/1.0/resources/validation.html" class="sidebar-link">Validation</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/1.0/resources/authorization.html" class="sidebar-link">Authorization</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/resources/authorization.html#policies" class="sidebar-link">Policies</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/authorization.html#fields" class="sidebar-link">Fields</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/authorization.html#index-filtering" class="sidebar-link">Index Filtering</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/authorization.html#relatable-filtering" class="sidebar-link">Relatable Filtering</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/resources/authorization.html#scout-filtering" class="sidebar-link">Scout Filtering</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Search</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/docs/1.0/search/global-search.html" class="sidebar-link">Global Search</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/1.0/search/scout-integration.html" class="sidebar-link">Scout Integration</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Filters</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/docs/1.0/filters/defining-filters.html" class="sidebar-link">Defining Filters</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/filters/defining-filters.html#select-filters" class="sidebar-link">Select Filters</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/filters/defining-filters.html#boolean-filters" class="sidebar-link">Boolean Filters</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/filters/defining-filters.html#date-filters" class="sidebar-link">Date Filters</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/filters/defining-filters.html#filter-titles" class="sidebar-link">Filter Titles</a></li></ul></li><li><a href="/docs/1.0/filters/registering-filters.html" class="sidebar-link">Registering Filters</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Lenses</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/docs/1.0/lenses/defining-lenses.html" class="active sidebar-link">Defining Lenses</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/1.0/lenses/registering-lenses.html" class="sidebar-link">Registering Lenses</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/lenses/registering-lenses.html#authorization" class="sidebar-link">Authorization</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Actions</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/docs/1.0/actions/defining-actions.html" class="sidebar-link">Defining Actions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/actions/defining-actions.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/actions/defining-actions.html#destructive-actions" class="sidebar-link">Destructive Actions</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/actions/defining-actions.html#action-fields" class="sidebar-link">Action Fields</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/actions/defining-actions.html#action-responses" class="sidebar-link">Action Responses</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/actions/defining-actions.html#queued-actions" class="sidebar-link">Queued Actions</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/actions/defining-actions.html#action-log" class="sidebar-link">Action Log</a></li></ul></li><li><a href="/docs/1.0/actions/registering-actions.html" class="sidebar-link">Registering Actions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/actions/registering-actions.html#authorization" class="sidebar-link">Authorization</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/actions/registering-actions.html#pivot-actions" class="sidebar-link">Pivot Actions</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Metrics</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/docs/1.0/metrics/defining-metrics.html" class="sidebar-link">Defining Metrics</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/metrics/defining-metrics.html#value-metrics" class="sidebar-link">Value Metrics</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/metrics/defining-metrics.html#trend-metrics" class="sidebar-link">Trend Metrics</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/metrics/defining-metrics.html#partition-metrics" class="sidebar-link">Partition Metrics</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/metrics/defining-metrics.html#caching" class="sidebar-link">Caching</a></li></ul></li><li><a href="/docs/1.0/metrics/registering-metrics.html" class="sidebar-link">Registering Metrics</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/metrics/registering-metrics.html#resource-detail-metrics" class="sidebar-link">Resource Detail Metrics</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/metrics/registering-metrics.html#dashboard-metrics" class="sidebar-link">Dashboard Metrics</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/metrics/registering-metrics.html#metric-sizes" class="sidebar-link">Metric Sizes</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/metrics/registering-metrics.html#authorization" class="sidebar-link">Authorization</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Customization</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/docs/1.0/customization/localization.html" class="sidebar-link">Localization</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/1.0/customization/tools.html" class="sidebar-link">Tools</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/customization/tools.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/tools.html#defining-tools" class="sidebar-link">Defining Tools</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/tools.html#registering-tools" class="sidebar-link">Registering Tools</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/tools.html#building-tools" class="sidebar-link">Building Tools</a></li></ul></li><li><a href="/docs/1.0/customization/resource-tools.html" class="sidebar-link">Resource Tools</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/customization/resource-tools.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/resource-tools.html#defining-tools" class="sidebar-link">Defining Tools</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/resource-tools.html#registering-tools" class="sidebar-link">Registering Tools</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/resource-tools.html#building-tools" class="sidebar-link">Building Tools</a></li></ul></li><li><a href="/docs/1.0/customization/cards.html" class="sidebar-link">Cards</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/customization/cards.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/cards.html#defining-cards" class="sidebar-link">Defining Cards</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/cards.html#registering-cards" class="sidebar-link">Registering Cards</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/cards.html#building-cards" class="sidebar-link">Building Cards</a></li></ul></li><li><a href="/docs/1.0/customization/fields.html" class="sidebar-link">Fields</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/customization/fields.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/fields.html#defining-fields" class="sidebar-link">Defining Fields</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/fields.html#registering-fields" class="sidebar-link">Registering Fields</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/fields.html#building-fields" class="sidebar-link">Building Fields</a></li></ul></li><li><a href="/docs/1.0/customization/frontend.html" class="sidebar-link">CSS / JavaScript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/customization/frontend.html#css" class="sidebar-link">CSS</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/frontend.html#javascript" class="sidebar-link">JavaScript</a></li></ul></li><li><a href="/docs/1.0/customization/filters.html" class="sidebar-link">Filters</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/1.0/customization/filters.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/filters.html#defining-filters" class="sidebar-link">Defining Filters</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/filters.html#registering-filters" class="sidebar-link">Registering Filters</a></li><li class="sidebar-sub-header"><a href="/docs/1.0/customization/filters.html#building-filters" class="sidebar-link">Building Filters</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="defining-lenses"><a href="#defining-lenses" aria-hidden="true" class="header-anchor">#</a> Defining Lenses</h1> <p></p><div class="table-of-contents"><ul><li><a href="#lens-filters">Lens Filters</a></li></ul></div><p></p> <p>While similar to filters, Nova lenses allow you to fully customize the underlying resource Eloquent query. For example, you may want to list of all your application's users sorted by their total lifetime revenue. Creating such a list may require you to join to additional tables and perform aggregate functions within the query. If it sounds complicated, don't worry - this is exactly the type of situation lenses are designed to solve:</p> <p><img src="/docs/assets/img/lens.a836687e.png" alt="Lens"></p> <p>To get started, you may use the <code>nova:lens</code> Artisan command. By default, Nova will place newly generated lenses in the <code>app/Nova/Lenses</code> directory:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>php artisan nova:lens MostValuableUsers
</code></pre></div><p>Each lens generated by Nova contains several methods. However, the two methods we are currently concerned with are the <code>query</code> and <code>fields</code> methods. The <code>query</code> method is responsible for building the Eloquent query that is needed to retrieve the desired data, while the <code>fields</code> method returns an array of fields that should be displayed when viewing the lens.</p> <p>To learn more, let's take a look at a complete lens definition that displays users and their lifetime revenue:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Lenses</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Fields<span class="token punctuation">\</span>ID</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Request</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Fields<span class="token punctuation">\</span>Text</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Lenses<span class="token punctuation">\</span>Lens</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Fields<span class="token punctuation">\</span>Number</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>DB</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Requests<span class="token punctuation">\</span>LensRequest</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MostValuableUsers</span> <span class="token keyword">extends</span> <span class="token class-name">Lens</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Get the query builder / paginator for the lens.
     *
     * @param  \Laravel\Nova\Http\Requests\LensRequest  $request
     * @param  \Illuminate\Database\Eloquent\Builder  $query
     * @return mixed
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">query</span><span class="token punctuation">(</span>LensRequest <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">withOrdering</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">withFilters</span><span class="token punctuation">(</span>
            <span class="token variable">$query</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">select</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">columns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                  <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'licenses'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'users.id'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'='</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'licenses.user_id'</span><span class="token punctuation">)</span>
                  <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'revenue'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'desc'</span><span class="token punctuation">)</span>
                  <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'users.id'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'users.name'</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Get the columns that should be selected.
     *
     * @return array
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">columns</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'users.id'</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'users.name'</span><span class="token punctuation">,</span>
            <span class="token constant">DB</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">raw</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'sum(licenses.price) as revenue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Get the fields available to the lens.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return array
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">fields</span><span class="token punctuation">(</span>Request <span class="token variable">$request</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token constant">ID</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'ID'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            Text<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Name'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

            Number<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Revenue'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'revenue'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token single-quoted-string string">'$'</span><span class="token punctuation">.</span><span class="token function">number_format</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Get the filters available for the lens.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return array
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">filters</span><span class="token punctuation">(</span>Request <span class="token variable">$request</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Get the URI key for the lens.
     *
     * @return string
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">uriKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token single-quoted-string string">'most-profitable-users'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">Columns Method</p> <p>In this example, the <code>columns</code> method has been extracted from the <code>query</code> method for readability. It is not &quot;required&quot; and is not a &quot;feature&quot; of lenses.</p></div> <p>As you can see in the example above, the <code>query</code> method has full control of the Eloquent query used to retrieve the lens data. The <code>fields</code> method may leverage any of Nova's fields in order to appropriately display the data retrieved by the query.</p> <h3 id="lens-filters"><a href="#lens-filters" aria-hidden="true" class="header-anchor">#</a> Lens Filters</h3> <p>Each Nova lens also contains a <code>filters</code> method. This method allows you to attach any of your existing <a href="/docs/1.0/filters/defining-filters.html">filters</a> to the lens:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Filters<span class="token punctuation">\</span>UserType</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Get the filters available for the lens.
 *
 * @param  \Illuminate\Http\Request  $request
 * @return array
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">filters</span><span class="token punctuation">(</span>Request <span class="token variable">$request</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">UserType</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/docs/1.0/filters/registering-filters.html" class="prev">
          Registering Filters
        </a></span> <span class="next"><a href="/docs/1.0/lenses/registering-lenses.html">
          Registering Lenses
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/docs/assets/js/app.bdf30820.js" defer></script><script src="/docs/assets/js/8.992bb95f.js" defer></script>
  </body>
</html>
